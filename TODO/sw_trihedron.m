% Generated using GBSolver generator Copyright Martin Bujnak,
% Zuzana Kukelova, Tomas Pajdla CTU Prague 2008.
% 
% Please refer to the following paper, when using this code :
%     Kukelova Z., Bujnak M., Pajdla T., Automatic Generator of Minimal Problem Solvers,
%     ECCV 2008, Marseille, France, October 12-18, 2008

function [x1 x2 x3 y1 y2 y3] = sw_trihedron(d_1, c_1)

	% precalculate polynomial equations coefficients
	c(1) = 1;
	c(2) = -d_1(1);
	c(3) = -c_1(1);
	c(4) = 1;
	c(5) = -d_1(2);
	c(6) = -c_1(2);
	c(7) = 1;
	c(8) = -d_1(3);
	c(9) = -c_1(3);
	c(10) = 1;
	c(11) = 1;
	c(12) = -1;
	c(13) = 1;
	c(14) = 1;
	c(15) = -1;
	c(16) = 1;
	c(17) = 1;
	c(18) = -1;

	M = zeros(213, 229);
	ci = [201, 413, 2716, 3354, 3566, 3778, 3990, 4415, 6118, 6330, 6755, 7606, 8244, 11813, 12025, 12237, 12449, 12874, 14577, 14789, 15001, 15213, 15638, 16489, 16914, 17552, 19894, 20106, 21596, 24325, 24537, 24749, 25174, 25386, 25811, 26236, 28152, 28364, 28789, 29640, 30917, 35581, 35793, 36218, 37069, 40263, 44092];
	M(ci) = c(1);

	ci = [1905, 2330, 5272, 7827, 8039, 8251, 8889, 9101, 10804, 11016, 11228, 11652, 17138, 17350, 17562, 18413, 18625, 20967, 21179, 21391, 21603, 21815, 22453, 22665, 22877, 23515, 23727, 24152, 30502, 30714, 30926, 31351, 31563, 31775, 31987, 33477, 33689, 33901, 34113, 34325, 41119, 41331, 41543, 41755, 43032, 46861];
	M(ci) = c(2);

	ci = [20436, 21074, 26572, 29127, 29552, 29764, 30402, 30827, 32530, 32742, 33167, 33592, 34230, 36521, 36946, 37158, 37583, 38008, 39498, 39710, 40135, 40347, 40772, 41197, 41622, 41834, 42259, 42471, 43109, 43495, 43920, 44132, 44557, 44769, 44981, 45406, 46044, 46256, 46468, 46680, 46892, 47296, 47508, 47720, 47932, 48357, 48565];
	M(ci) = c(3);

	ci = [205, 417, 629, 841, 2942, 3367, 4005, 4217, 4642, 5067, 5279, 6130, 6342, 6554, 7405, 8043, 9107, 11828, 12466, 12678, 13103, 13528, 13740, 14591, 14803, 15441, 16292, 16504, 16716, 17354, 18631, 21399, 24336, 24974, 25612, 25824, 26036, 26461, 27099, 28163, 28588, 29439, 30716, 35586, 36011, 36862, 37926, 40055, 43880];
	M(ci) = c(4);

	ci = [1483, 1908, 2120, 5285, 6988, 7839, 8051, 8476, 9539, 10177, 10389, 10601, 11451, 11663, 15875, 17152, 17364, 18002, 19065, 20342, 20554, 20766, 21829, 22041, 22253, 22891, 23955, 29235, 30086, 31362, 31574, 32211, 33062, 33274, 34124, 40698, 40910, 41760, 42824, 46649];
	M(ci) = c(5);

	ci = [20653, 21291, 21929, 22567, 27224, 29353, 30630, 30842, 31480, 31905, 32330, 32755, 32967, 33179, 33604, 34242, 34454, 36749, 37813, 38025, 38450, 38875, 39087, 39725, 39937, 40788, 41213, 41425, 41637, 41849, 42061, 43125, 43719, 44570, 44995, 45207, 45419, 45631, 45843, 46268, 46480, 46692, 46904, 47514, 47726, 47938, 48150, 48362, 48566];
	M(ci) = c(6);

	ci = [635, 1273, 1698, 1910, 2742, 3593, 4444, 4656, 5933, 6571, 7209, 7634, 7846, 9762, 9974, 10186, 11037, 12056, 12907, 13119, 14396, 15034, 15459, 16097, 16522, 17160, 19502, 19714, 19926, 20351, 21202, 23118, 24558, 24983, 25834, 27750, 27962, 28174, 29025, 30515, 32644, 35378, 35590, 36441, 37718, 39634, 43455];
	M(ci) = c(7);

	ci = [1061, 1912, 2549, 3168, 4871, 5509, 5721, 7850, 8701, 9338, 9550, 11252, 11464, 11676, 13334, 13972, 14184, 17165, 17803, 18228, 19078, 19290, 21844, 22056, 22268, 22906, 23970, 26688, 26900, 27538, 31370, 31582, 32219, 34135, 38360, 38572, 39209, 41764, 45585];
	M(ci) = c(8);

	ci = [22148, 23212, 23637, 24062, 26811, 30005, 31282, 31707, 32771, 33409, 33621, 34046, 34258, 34683, 34895, 35107, 35319, 37403, 38254, 38679, 39743, 40594, 41019, 41231, 41656, 41868, 42293, 42505, 42717, 42929, 43141, 43353, 44367, 44792, 45430, 46068, 46280, 46492, 46704, 46916, 47128, 47519, 47731, 47943, 48155, 48367, 48567];
	M(ci) = c(9);

	ci = [852, 1277, 1702, 2340, 2964, 4241, 5092, 5943, 7220, 7432, 8922, 9773, 10837, 12703, 13554, 14405, 16108, 16320, 18449, 19513, 21003, 25627, 27756, 30311, 32440, 37510, 39426];
	M(ci) = c(10);

	ci = [1065, 1490, 2128, 2553, 3177, 4880, 5731, 7008, 8498, 8710, 9561, 10625, 11476, 13342, 14193, 15896, 18025, 18237, 19301, 20791, 22281, 26905, 30099];
	M(ci) = c(11);

	ci = [22791, 23429, 23854, 24279, 27459, 31292, 32143, 32994, 33845, 34057, 34482, 34907, 35332, 38263, 39114, 39965, 41455, 41667, 42092, 42517, 43155, 45436, 46287, 46925, 47137, 48160, 48372];
	M(ci) = c(12);

	ci = [3820, 6801, 9995, 10420, 12284, 15265, 15690, 19736, 20161, 20586, 23354, 24781, 25206, 27974, 28399, 29250, 32870, 35384, 35809, 36660, 39854, 43669];
	M(ci) = c(13);

	ci = [5524, 9357, 11698, 13988, 18886, 19098, 22505, 22717, 22929, 24206, 27337, 27549, 31808, 32020, 32232, 34361, 38792, 39004, 39216, 41984, 45799];
	M(ci) = c(14);

	ci = [30019, 33426, 34703, 35128, 37418, 40612, 41037, 42314, 42739, 42951, 43376, 44377, 44802, 46079, 46504, 46716, 47141, 47312, 47737, 47949, 48374, 48568];
	M(ci) = c(15);

	ci = [13781, 13993, 16761, 16973, 17824, 18888, 25429, 26067, 26279, 26704, 27342, 28619, 28831, 29895, 31172, 36028, 36240, 37304, 38155, 40497, 44309];
	M(ci) = c(16);

	ci = [22514, 22939, 23577, 23789, 24001, 24213, 33097, 33522, 33734, 34159, 34371, 34583, 34795, 35007, 35219, 42205, 42417, 42842, 43054, 43266, 47078];
	M(ci) = c(17);

	ci = [38915, 39340, 41256, 41468, 41893, 42105, 44599, 45024, 45236, 45661, 45873, 46085, 46297, 46722, 46934, 47317, 47529, 47954, 48166, 48378, 48569];
	M(ci) = c(18);


	Mr = rref(M);  % replace me with a MEX

	A = zeros(16);
	amcols = [229 228 227 226 225 224 223 222 221 220 219 218 217 214 204 201];
	A(1, 3) = 1;
	A(2, 9) = 1;
	A(3, :) = -Mr(213, amcols);
	A(4, :) = -Mr(212, amcols);
	A(5, 14) = 1;
	A(6, :) = -Mr(211, amcols);
	A(7, :) = -Mr(210, amcols);
	A(8, :) = -Mr(202, amcols);
	A(9, :) = -Mr(198, amcols);
	A(10, :) = -Mr(197, amcols);
	A(11, :) = -Mr(196, amcols);
	A(12, :) = -Mr(195, amcols);
	A(13, :) = -Mr(194, amcols);
	A(14, :) = -Mr(184, amcols);
	A(15, :) = -Mr(166, amcols);
	A(16, :) = -Mr(160, amcols);

	[V D] = eig(A);
	sol =  V([7, 6, 5, 4, 3, 2],:)./(ones(6, 1)*V(1,:));

	if (find(isnan(sol(:))) > 0)
		
		x1 = [];
		x2 = [];
		x3 = [];
		y1 = [];
		y2 = [];
		y3 = [];
	else
		
		I = find(not(imag( sol(1,:) )));
		x1 = sol(1,I);
		x2 = sol(2,I);
		x3 = sol(3,I);
		y1 = sol(4,I);
		y2 = sol(5,I);
		y3 = sol(6,I);
	end
end
